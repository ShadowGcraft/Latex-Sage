% !TEX TS-program = sage 
% !TEX TS-program = xelatex
% !TEX encoding = UTF-8 Unicode
% The following lines are standard LaTeX preamble statements.


%\documentclass[a4paper,12pt]{smfart}

%\documentclass[a4paper,11pt]{book}
%\documentclass[a4paper,landscape,20pt]{extarticle} %% landscape ou bien portrait (par défault)

%\documentclass[a4paper,17pt]{extarticle} %% on peut utiliser les tailles: 8pt, 9pt,14pt, 17pt et 20pt

%\documentclass[a4paper,12pt]{report}
\documentclass[a4paper,landscape,17pt]{extreport} %% on peut utiliser les tailles: 8pt, 9pt,14pt, 17pt et 20pt


\usepackage[french]{babel}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}

%\usepackage{amsmath,amssymb,amsfonts,url,xspace,smfthm}
\usepackage{amsmath,amsthm,amssymb,amsfonts,url,xspace}
\usepackage{mathtools}
\usepackage[mathscr]{eucal}
%\usepackage{exscale}

\usepackage{diagbox}

\usepackage{fancybox}

\usepackage{xcolor}

%%%%%%%%%%%%%%%%%%%%%%
% - les theoremes
\newtheorem{definition}{D\'efinition}
\newtheorem{theoreme}{Th\'eor\`eme}
\newtheorem{proposition}{Proposition}
\newtheorem{lemme}{Lemme}
\newtheorem{corollaire}{Corollaire}
\newtheorem{propriete}{Propri\'et\'e}
\newtheorem{axiome}{Axiome}
\newcommand{\initialisecompteurs}{
       \setcounter{definition}{0}%
       \setcounter{theoreme}{0}%
       \setcounter{proposition}{0}%
       \setcounter{lemme}{0}%
       \setcounter{corollaire}{0}%
       \setcounter{propriete}{0}%
       \setcounter{axiome}{0}%
       \setcounter{section}{0}%
       \setcounter{subsection}{0}%
       \setcounter{subsubsection}{0}%
}

\usepackage[left=.5cm, right=.5cm, top=1.5cm, bottom=1.5cm, bindingoffset=0.cm, headsep=0.cm,headheight=0.cm]{geometry}

%\usepackage{qrcode}
%\usepackage[draft,forget]{qrcode}
%\usepackage{rmsmacros} 
\usepackage{graphicx}
%\usepackage{hyperref}
%\usepackage[hidelinks]{hyperref}
%\usepackage{tabvar}
\usepackage[tight]{shorttoc}
\newcommand{\sommaire}{\shorttoc{Sommaire}{1}}

\graphicspath{ {./images/} }
\everymath{\displaystyle}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% Sélection des fontes
%\usepackage{fontspec}  % fontspec et xunicode sont facultatifs
%\setmainfont[Ligatures=TeX]{Helvetica}   % Police romaine, utilisée dans le corps du document
%\setmainfont[Ligatures=TeX]{Lucida Grande}   % Police romaine, utilisée dans le corps du document

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{ccfonts,amssymb} 
\usepackage[euler-digits]{eulervm} 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\def\eclaire{\mathbb}

\def\R{\ensuremath{\eclaire R}}
\def\N{\ensuremath{\eclaire N}}
\def\C{\ensuremath{\eclaire C}}
\def\Z{\ensuremath{\eclaire Z}}
\def\Q{\ensuremath{\eclaire Q}}

\def\Id{\ensuremath{\mathrm{Id}}}

%\newcommand{\sh}{\mathop{\mathrm{sh}}\nolimits}
\renewcommand{\sinh}{\mathop{\mathrm{sh}}}
\renewcommand{\cosh}{\mathop{\mathrm{ch}}}
\renewcommand{\tanh}{\mathop{\mathrm{th}}}

\renewcommand{\arg}{\mathop{\mathrm{Arg}}}

\renewcommand{\arcsin}{\mathop{\mathrm{Arc\mspace{2mu}sin}}}
\renewcommand{\arccos}{\mathop{\mathrm{Arc\mspace{2mu}cos}}}
\renewcommand{\arctan}{\mathop{\mathrm{Arc\mspace{2mu}tan}}}
\renewcommand{\Im}{\mathop{\mathfrak{I}\mathrm{m}}}
\renewcommand{\Re}{\mathop{\mathfrak{R}\mathrm{m}}}


%\DeclareMathOperator{\sh}{sh}
%\DeclareMathOperator{\ch}{ch}


\renewcommand{\baselinestretch}{1.5}


% Only one command is required to use Sage within the LaTeX source:
\usepackage{sagetex}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\limh}[1]{\lim\limits_{h\to 0} \frac{#1(x+h)-#1(x)}{h}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%




\begin{document} 

%\pagecolor{gray!45}

\setlength{\parindent}{0pt}


%\bf \Huge

\title{Les primitives et les dérivées.}
\date{Ce document est destiné à un affichage sur un écran et non pas à une impression sur papier.}


\author{Louis Herzog} 

\maketitle 

\setcounter{tocdepth}{2}
\tableofcontents
%\sommaire


\begin{abstract}
On se propose dans ce document d'étudier la trigonométrie rectiligne et la trigonométrie hyperbolique. La trigonométrie sphérique ne sera pas abordée dans ce document.

Quelques considérations préliminaires sur le calcul de certaines primitives telles que celles des fonctions 
 $x \mapsto \arccos(x) $,  $x \mapsto \arcsin(x) $ ou bien $x \mapsto \arctan(x) $ une astuce est indispensable. Elle consiste à procéder à une intégration par parties. En effet, n'ayant aucune idée des primitives, il est raisonnable de changer leurs rôles respectifs et de considérer, non plus la fonction initiale, mais sa dérivée.
 
Le premier objectif est donc de vérifier si celles-ci existent et sont calculables.


\end{abstract} 

\chapter{Établissement des outils indispensables.}
 
\section{Quelques formules de la trigonométrie rectiligne.} 
\begin{equation} 
\quad \sin^2(x) + \cos^2(x)  = 1 
\end{equation}
\begin{equation} 
\quad \sin(a+b)  = \sin(a)\cos(b) + \cos(a)\sin(b) 
\end{equation}
\begin{equation} 
\quad \cos(a+b)  = \cos(a)\cos(b) - \sin(a)\sin(b)  
\end{equation}


\section{Quelques formules de la trigonométrie hyperbolique.}
Remarque:
on passe des formules de la trigonométrie linéaire aux formules de la trigonométrie hyperbolique en remplaçant $\cos$ par $\cosh$ et $\sin$ par $i . \sinh$.
\begin{equation*}
\quad  (i.\sinh\nolimits(x))^2 + \cosh\nolimits^2(x)  = 1 
\end{equation*}
\begin{equation}
\quad  -\sinh\nolimits^2(x) + \cosh\nolimits^2(x)  = 1 
\end{equation}
\begin{equation*}
i . \sinh(a+b)  = i . \sinh(a)\cosh(b) + \cosh(a)(i . \sinh(b)) \quad \textrm{puis en divisant par } i 
\end{equation*}
\begin{equation}
\quad \sinh(a+b)  = \sinh(a)\cosh(b) + \cosh(a) \sinh(b)
\end{equation} 
\begin{equation*}
\cosh(a+b)  = \cosh(a)\cosh(b) - (i. \sinh(a)) (i.\sinh(b)) \quad \textrm{autrement écrit} 
\end{equation*}
\begin{equation}
\quad \cosh(a+b)  = \cosh(a)\cosh(b) + \sinh(a) \sinh(b) 
\end{equation}





\chapter{Fonctions trigonométriques et trigonométriques inverses.}


\section{La fonction  $x \mapsto \cos(x)$.}

Définissons nos fonctions dans {\texttt{Sage}}. Soit
\begin{sageblock}
    f(x) = cos(x)
    g(x) = diff(f(x),x)
    F(x) = integrate(f(x),x)
\end{sageblock}
\begin{center}
\sageplot[width=.3\textwidth]{plot(cos(x), x, -pi, pi)} \\
La représentation graphique de $x\mapsto \cos(x)$ sur l'intervalle $[-\pi, \pi]$.
\end{center}
La fonction est paire et périodique de période $2 \pi$.

\subsection{Dérivée de la fonction $x \mapsto \cos(x)$.}

\begin{align*}
\lim_{h\to 0} \frac{\cos(x+h)-cos(x)}{h}  
& = \lim_{h\to 0} \frac{\cos(x)\cos(h)-\sin(x)\sin(h)-cos(x)}{h} \\ 
& = \lim_{h\to 0} \left( \frac{\cos(x)(\cos(h)-1)}{h}-\frac{\sin(x)\sin(h)}{h} \right) \\  
& =  \cos(x) \times \lim_{h\to 0}\frac{\cos(h)-1}{h}- \sin(x) \times \lim_{h\to 0} \frac{\sin(h)}{h}\\  
& = -\sin{x}
\end{align*}

\subsection{Calcul d'une primitive de la fonction  $x \mapsto \cos(x)$.}

Dans la section suivante, on calcule la dérivée de la fonction $x \mapsto \sin(x)$ qui vaut $x \mapsto \cos(x)$, par conséquent une primitive de $x \mapsto \cos(x)$ est égale, à une constante près, à $  \sin(x) + C^{ste} $.

On vérifie ce résultat avec Sage.
Une primitive de la fonction $x \mapsto \sage{f(x)}$  est la fonction $x \mapsto \sage{F(x)} + C^{ste} $ définie à une constante près.


\section{La fonction  $x \mapsto \sin(x)$.}

Définissons nos fonctions dans {\texttt{Sage}}
\begin{sageblock}
    f(x) = sin(x)
    g(x) = diff(f(x),x)
    F(x) = integrate(f(x),x)
\end{sageblock}


\begin{center}
\sageplot[width=.3\textwidth]{plot(sin(x), x, -pi, pi)} \\
La représentation graphique de $x\mapsto \sin(x)$ sur l'intervalle $[-\pi, \pi]$.
\end{center}
La fonction est impaire et périodique de période $2 \pi$.

\subsection{Dérivée de la fonction $x \mapsto \sin(x)$.}

\begin{align*}
\lim_{h\to 0} \frac{\sin(x+h)-sin(x)}{h} & = \lim_{h\to 0} \frac{\sin(x)\cos(h)+\cos(x)\sin(h)-\sin(x)}{h} \\  & =  \lim_{h\to 0} \frac{\sin(x)(\cos(h)-1)}{h}+\frac{\cos(x)\sin(h)}{h} \\ & = \sin(x) \times  \lim_{h\to 0} \frac{\cos(h)-1}{h}+\cos(x) \times  \lim_{h\to 0}  \frac{\sin(h)}{h} \\ & = \cos{x}
\end{align*}

\subsection{Calcul d'une primitive de la fonction  $x \mapsto \sin(x)$.}

Dans la section précédente, on a calculé la dérivée de la fonction $x \mapsto \cos(x)$ qui vaut $x \mapsto -\sin(x)$, par conséquent une primitive de $x \mapsto \sin(x)$ est égale, à une constante près, à $ - \cos(x) + C^{ste} $.

On vérifie ce résultat avec Sage.

Une primitive de $\sage{f(x)}$ est $ \sage{F(x)} + C^{ste} $ définie à une constante près.


\section{La fonction  $x \mapsto \tan(x)$.}

Définissons nos fonctions dans {\texttt{Sage}}
\begin{sageblock}
    f(x) = tan(x)
    g(x) = diff(f(x),x)
    F(x) = integrate(f(x),x)
\end{sageblock}



\begin{center}
\sageplot[width=.3\textwidth]{plot(tan(x), x, -1.4, 1.4)} \\
La représentation graphique de $x\mapsto \tan(x)$ sur l'intervalle ouvert $ \left] -\frac{\pi}{ 2} , \frac{\pi}{ 2} \right[ $.
\end{center}


La fonction $x \mapsto \tan(x)$ étant périodique de période $\pi$, on choisit de restreindre le domaine de définition à l'intervalle ouvert $ \left] -\frac{\pi}{ 2} , \frac{\pi}{ 2} \right[ $.


\subsection{Dérivée de la fonction $x \mapsto \tan(x)$.}

\begin{align*}
\tan(x)' 
& =  \left(\frac{\sin(x)}{\cos(x)}\right)' \\ 
& =  \frac{\cos(x) \times \cos(x) - (-\sin(x)) \times \sin(x)}{\cos^2(x)}  \\ 
& =  \frac{\cos(x) \times \cos(x) + \sin(x)\times \sin(x)}{\cos^2(x)}  \\ 
& =  \frac{1}{\cos^2(x)} = 1 + \tan^2(x)
\end{align*}

\subsubsection{Vérification avec Sage}


La dérivée de $\sage{f(x)} = \sage{g(x)} $.


\subsection{Calcul d'une primitive de la fonction  $x \mapsto \tan(x)$.}

On a $\tan(x)=\frac{\sin(x)}{\cos(x)}$, alors $\int \tan(x) \, dx =\int \frac{\sin(x)}{\cos(x)}\, dx$.\\
Je pose $u(x)=\cos(x)$ donc $u'(x)= -\sin(x) \,dx$ et par ce changement de variable on a $\int \tan(x) \, dx = \int \frac{\sin(x)}{\cos(x)}\, dx  = -\int \frac{u'}{u} = -\ln|u|  = \ln\left(\frac{1}{|u|}\right)  = \ln\left(\frac{1}{|\cos(x)|}\right) +C^{ste}$.

Or, on a choisi le domaine de définition de la fonction $x \mapsto \tan(x)$ restreint à l'intervalle ouvert $ \left] -\frac{\pi}{ 2} , \frac{\pi}{ 2} \right[ $, par conséquent $\cos(x)$ est positif sur cet intervalle donc $|\cos(x)| = \cos(x)$.

Finalement $ \ln\left(\frac{1}{\cos(x)}\right) +C^{ste}$ est une primitive de $x \mapsto \tan(x)$.


\subsubsection*{Vérification avec Sage}


Une primitive de $\sage{f(x)}$ est la fonction définie à une constante près $x \mapsto \sage{F(x)} + C^{ste} $.

La fonction $x\mapsto \sec$ est la fonction paire $x\mapsto \frac{1}{\cos(x)}$ périodique de période $2\pi$ définie sur $\R-\{ \frac{\pi}{2}+k\pi, k\in\Z\}$. On retrouve bien le résultat précédent.


\section{La fonction  $x \mapsto \arccos(x) $.}


La restriction de la fonction $x \mapsto \cos(x) $ à l'intervalle $[0,\pi]$ est une bijection de $[0,\pi] \rightarrow [-1,1]$ . Il existe donc une fonction réciproque à la fonction $x \mapsto \cos(x) $ que l'on nomme $x \mapsto \arccos(x) $. C'est également une bijection, elle est continue sur l'intervalle fermé  $ [-1,1]$ et est dérivable sur l'intervalle ouvert $]-1,1[$.

\subsection{Calcul de la dérivée de la fonction $x \mapsto \arccos(x) $.}

Définissons nos fonctions dans {\texttt{Sage}}
\begin{sageblock}
    f(x) = tanh(x)
    g(x) = diff(f(x),x)
    F(x) = integrate(f(x),x)
\end{sageblock}


Pour ce calcul, il faut utiliser le calcul de la dérivée d'une fonction composée. On a $\cos(\arccos(x))=x$, par conséquent la dérivée de cette expression s'exprime par $ -\sin(\arccos(x) \times \arccos(x)' = 1$, d'où $\arccos(x)' = \frac{-1}{\sin(\arccos(x))} $.

La difficulté est maintenant de déterminer $\sin(\arccos(x))$, or on sait que pour tout $X \in \R$, on a $\sin^2(X) + \cos^2(X) = 1$, d'où $\sin(X) = \sqrt{1-\cos^2(X)}$.

En remplaçant $X$ par $\arccos(x)$, 
on a $\sin(\arccos(x)) = \sqrt{1-\cos^2(\arccos(x))} = \sqrt{1- x^2}$.

Finalement, $\arccos(x)' = \frac{-1}{\sin(\arccos(x))} = \frac{-1}{\sqrt{1-\cos^2(\arccos(x))}} =  \frac{-1}{\sqrt{1- x^2}} $.

\subsubsection*{Vérification avec Sage}


La dérivée de la fonction $\sage{f(x)}$ est la fonction $x \mapsto \sage{g(x)} $, ce que l'on retrouve sous une écriture légèrement modifiée de Sage.


\begin{center}
\sageplot[width=.45\textwidth]{plot(f(x), x, -1, 1)}
\sageplot[width=.45\textwidth]{plot(cos(x), x, 0, pi)}\\
Les représentations graphiques de $x \mapsto \sage{f(x)} $ et de $x\mapsto \cos(x)$.
\end{center}

On peut maintenant entreprendre le calcul de la primitive de la  fonction  $x \mapsto \arccos(x) $.

\subsection{Calcul de la primitive de la fonction  $x \mapsto \arccos(x) $.}


Je pose que $u(x)$  est égal à la fonction $\arccos(x)$ et $v'(x)$ est égal $1$  d'où $u'(x)$  est égal à la fonction $ \frac{-1}{\sqrt{1- x^2}} $ et $v(x)$ est égal $x$.

Alors on a, par une intégration par parties, $\int \arccos(x) \, dx = x \times \arccos(x) -\int \frac{-1}{\sqrt{1- x^2}} \times x \, dx =  x \arccos(x) + \int \frac{x}{\sqrt{1- x^2}} \, dx $.


\subsubsection*{Calcul de $\int \frac{x}{\sqrt{1- x^2}} \, dx $.}

$\int \frac{x}{\sqrt{1- x^2}} \, dx = \frac{-1}{2} \int \frac{d(1-x^2)}{\sqrt{1- x^2}}= -\sqrt{1- x^2} $.


Finalement $\int \arccos(x) \, dx = x  \arccos(x) - \sqrt{1- x^2} + C^{ste} $ est une primitive de la fonction $x \mapsto \arccos(x) $.

\subsubsection*{Vérification avec Sage}

Une primitive de $\sage{f(x)} = \sage{F(x)} + C^{ste}$.


\section{La fonction  $x \mapsto \arcsin(x) $.}

La restriction de la fonction $x \mapsto \sin(x) $ à l'intervalle $\left[-\frac{\pi}{2},\frac{\pi}{2}\right]$ est une bijection de $\left[-\frac{\pi}{2},\frac{\pi}{2}\right] \rightarrow [-1,1]$ . Il existe donc une fonction réciproque à la fonction $x \mapsto \sin(x) $ que l'on nomme $x \mapsto \arcsin(x) $. C'est également une bijection, elle est continue sur l'intervalle fermé  $ [-1,1]$ et est dérivable sur l'intervalle ouvert $]-1,1[$.

\subsection{Calcul de la dérivée de la fonction $x \mapsto \arcsin(x) $.}

Définissons nos fonctions dans {\texttt{Sage}}
\begin{sageblock}
    f(x) = arcsin(x)
    g(x) = diff(f(x),x)
    F(x) = integrate(f(x),x)
\end{sageblock}


Pour ce calcul, il faut utiliser le calcul de la dérivée d'une fonction composée. On a $\sin(\arcsin(x))=x$, par conséquent la dérivée de cette expression s'exprime par $ \cos(\arcsin(x)) \times \arcsin(x) ' = 1$, d'où $\arcsin(x) ' = \frac{1}{\cos(\arcsin(x))} $.

La difficulté est maintenant de déterminer $\cos(\arcsin(x))$, or on sait que pour tout $X \in \R$, on a $\sin^2(X) + \cos^2(X) = 1$, d'où $\cos(X) = \sqrt{1-\sin^2(X)}$.

En remplaçant $X$ par $\arcsin(x)$, 

on a $\cos(\arcsin(x)) = \sqrt{1-\sin^2(\arcsin(x))} = \sqrt{1- x^2}$.

Finalement, $\arcsin(x) ' = \frac{1}{\cos(\arcsin(x))}  = \frac{1}{\sqrt{1-\sin^2(\arcsin(x))}} =  \frac{1}{\sqrt{1- x^2}} $.

\subsubsection{Vérification avec Sage}

La dérivée de $\sage{f(x)} = \sage{g(x)} $.


\begin{center}
\sageplot[width=.45\textwidth]{plot(f(x), x, -1, 1)}
\sageplot[width=.45\textwidth]{plot(sin(x), x, -pi/2, pi/2)}\\
Les représentations graphiques de $x \mapsto \sage{f(x)} $ et de $x\mapsto \sin(x)$.
\end{center}


On peut maintenant entreprendre le calcul de la primitive de la  fonction  $x \mapsto \arcsin(x) $.

\subsection{Calcul de la primitive de la fonction  $x \mapsto \arcsin(x) $.}


Je pose que $u(x)$  est égal à la fonction $\arcsin(x)$ et $v'(x)$ est égal $1$  d'où $u'(x)$  est égal à la fonction $\arcsin(x) ' = \frac{1}{\sqrt{1- x^2}} $ et $v(x)$ est égal $x$.

Alors on a $\int \arcsin(x) \, dx = x \times \arcsin(x) -\int \frac{1}{\sqrt{1- x^2}} \times x \, dx $.


\subsubsection{Calcul de $\int \frac{x}{\sqrt{1- x^2}} \, dx $.}

$\int \frac{x}{\sqrt{1- x^2}} \, dx = \frac{1}{2} \int \frac{d(1-x^2)}{\sqrt{1- x^2}}= \sqrt{1- x^2} $.


Finalement, une primitive de la fonction $x \mapsto \arcsin(x) $ est une fonction  $ x \mapsto x \arcsin(x) - \sqrt{1- x^2} + C^{ste} $.

\subsubsection{Vérification avec Sage}


Une primitive de la fonction $\sage{f(x)} = \sage{F(x)} + C^{ste}$.


\section{La fonction  $x \mapsto \arctan(x) $.}


La restriction de la fonction $x \mapsto \tan(x) $ à l'intervalle $\left[-\frac{\pi}{2},\frac{\pi}{2}\right]$ est une bijection de $\left[-\frac{\pi}{2},\frac{\pi}{2}\right] \rightarrow \R $. Il existe donc une fonction réciproque à la fonction $x \mapsto \tan(x) $ que l'on nomme $x \mapsto \arctan(x) $. C'est également une bijection, elle est continue sur l'intervalle fermé  $ [-1,1]$ et est dérivable sur l'intervalle ouvert $]-1,1[$.


\subsection{Calcul de la dérivée de la fonction $x \mapsto \arctan(x) $.}
Définissons nos fonctions dans {\texttt{Sage}}
\begin{sageblock}
    f(x) = arctan(x)
    g(x) = diff(f(x),x)
    F(x) = integrate(f(x),x)
\end{sageblock}



Pour ce calcul, il faut utiliser le calcul de la dérivée d'une fonction composée. On a $\tan(\arctan(x))=x$, par conséquent la dérivée de cette expression s'exprime par $ \tan'(\arctan(x)) \times \arctan(x)' = 1$, d'où $\arctan(x)' = \frac{1}{\tan'(\arctan(x))} $.

La difficulté est maintenant de déterminer $\tan'(\arctan(x)$, or on sait que pour tout $X \in \R$, on a $ \tan'(x) =1+\tan^2(x) $, d'où $\tan'(\arctan(x)) = 1+x^2$.

Finalement, $\arctan(x)' = \frac{1}{1+x^2}$.

\subsubsection*{Vérification avec Sage}


La dérivée de $\sage{f(x)} = \sage{g(x)} $.


\begin{center}
\sageplot[width=.45\textwidth]{plot(f(x), x, -10, 10)} 
\sageplot[width=.45\textwidth]{plot(tan(x), x, -1.4, 1.4)}\\
Les représentations graphiques de $x \mapsto \sage{f(x)} $ et de $x\mapsto \tan(x)$.
\end{center}


On peut maintenant entreprendre le calcul de la primitive de la  fonction  $x \mapsto \arctan(x) $.


\subsection{Calcul de la primitive de la fonction  $x \mapsto \arctan(x) $.}


Je pose que $u(x)$  est égal à la fonction $\arctan(x)$ et $v'(x)$ est égal $1$  d'où $u'(x)$  est égal à la fonction $ \frac{1}{1+ x^2} $ et $v(x)$ est égal $x$.

Alors on a $\int \arctan(x) \, dx = x \times \arctan(x) -\int \frac{1}{1+x^2} \times x \, dx $.

\subsubsection{Calcul de $\int \frac{x}{1+ x^2} \, dx $.}

$\int \frac{x}{1+ x^2} \, dx = \frac{1}{2} \int \frac{d(1+x^2)}{1+ x^2} $.

D'où $\int \arctan(x) \, dx = x \arctan(x) - \frac{1}{2} \ln \left| 1+ x^2 \right| + C^{ste} $. 
Finalement, une primitive de la fonction $x \mapsto \arctan(x) $ est une fonction $x \mapsto x \arctan(x) -\ln\left( \sqrt{1+ x^2}\right) + C^{ste} $ ou encore $x \mapsto x \arctan(x) +\ln\left( \frac{1}{\sqrt{1+ x^2}}\right) + C^{ste} $.


\subsubsection{Vérification avec Sage}

Une primitive de $\sage{f(x)} = \sage{F(x)} + C^{ste}$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Fonctions hyperboliques et hyperboliques inverses.}


On passe des formules de trigonométrie aux formules de trigonométries hyperboliques en remplaçant $\cos$ par $\cosh$ et $\sin$ par $i . \sinh$. Par exemple pour $\cos^2+\sin^2=1$
nous obtenons $(\cosh)^2 + (i . \sinh)^2= (\cosh)^2 - (\sinh)^2 = 1$ et pour $\cos(a+b)=\cos(a) \cos(b) - \sin(a) \sin(b) $, nous obtenons $\cosh(a+b)=\cosh(a) \cosh(b) - i .\sinh(a) i . \sinh(b) $ c'est-à-dire $\cosh(a+b)=\cosh(a) \cosh(b) - (i)^2 \sinh(a) \sinh(b) $. \\ Finalement on a $\cosh(a+b) = \cosh(a) \cosh(b) + \sinh(a) \sinh(b) $. On change de signe!


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{La fonction  $x \mapsto \cosh(x)$.}

Définissons nos fonctions dans {\texttt{Sage}}
\begin{sageblock}
    f(x) = cosh(x)
    g(x) = diff(f(x),x)
    F(x) = integrate(f(x),x)
\end{sageblock}



\begin{center}
\sageplot[width=.4\textwidth]{plot(cosh(x), x, -4, 4)}
\sageplot[width=.4\textwidth]{plot(diff(cosh(x),x), x, -4, 4)} \\
La représentation graphique de $x \mapsto \sage{cosh(x)} $ et de sa dérivée. 
\end{center}

\subsection{Dérivée de la fonction $x \mapsto \cosh(x)$.}
\begin{align*}
\cosh(x)' & = \left( \frac{\exp(x)+\exp(-x)}{2} \right)' \\ 
& = \frac{\exp(x)'+\exp(-x)'}{2} \\
& = \frac{\exp(x)-\exp(-x)}{2} \\
& = \sinh(x)
\end{align*}




\subsection{Calcul d'une primitive de la fonction  $x \mapsto \cosh(x)$.}

$\int \cosh(x) dx = \int \frac{\exp(x)+ \exp(-x)}{2} dx = \frac{1}{2} \times \int \exp(x) dx + \int \exp(x) dx = \frac{1}{2} \times \exp(x) - \exp(-x) = \sinh + C^{ste}$


\subsubsection{Vérification avec Sage}

Une primitive de $\sage{f(x)} = \sage{F(x)} + C^{ste}$.




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{La fonction  $x \mapsto \sinh(x)$.}

Définissons nos fonctions dans {\texttt{Sage}}
\begin{sageblock}
    f(x) = sinh(x)
    g(x) = diff(f(x),x)
    F(x) = integrate(f(x),x)
\end{sageblock}



\begin{center}
\sageplot[width=.4\textwidth]{plot(sinh(x), x, -4, 4)}
\sageplot[width=.4\textwidth]{plot(diff(sinh(x), x), x, -4, 4)} \\
La représentation graphique de $x \mapsto \sage{sinh(x)} $ et de sa dérivée. 
\end{center}


\subsection{Dérivée de la fonction $x \mapsto \sinh(x)$.}

\begin{align*}
\sinh(x)' & = \left( \frac{\exp(x)-\exp(-x)}{2} \right)' \\ 
& = \frac{\exp(x)'-\exp(-x)'}{2} \\
& = \frac{\exp(x)+\exp(-x)}{2} \\
& = \cosh(x)
\end{align*}


\subsection{Calcul d'une primitive de la fonction  $x \mapsto \sinh(x)$.}


$\int \sinh(x) dx = \int \frac{\exp(x)- \exp(-x)}{2} dx = \frac{1}{2} \times \int \exp(x) dx - \int \exp(x) dx = \frac{1}{2} \times \exp(x) + \exp(-x) = \cosh(x) + C^{ste}$


\subsubsection{Vérification avec Sage}

Une primitive de $\sage{f(x)} = \sage{F(x)} + C^{ste}$.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{La fonction  $x \mapsto \tanh(x)$.}

Définissons nos fonctions dans {\texttt{Sage}}
\begin{sageblock}
    f(x) = tanh(x)
    g(x) = diff(f(x),x)
    F(x) = integrate(f(x),x)
\end{sageblock}


\begin{center}
\sageplot[width=.4\textwidth]{plot(tanh(x), x, -4, 4)} 
\sageplot[width=.4\textwidth]{plot(diff(tanh(x), x) , x, -4, 4)} \\
La représentation graphique de $x \mapsto \sage{tanh(x)} $ et de sa dérivée.
\end{center}

\subsection{Dérivée de la fonction $x \mapsto \tanh(x)$.}

\begin{align*}
(\tanh(x))' & =  \left(\frac{\sinh(x)}{\cosh(x)}\right)' \\
&  =  \frac{\sinh(x)' \times \cosh(x) - \cosh(x)' \times \sinh(x)}{\cosh(x)^2} \\ 
&  =   \frac{\cosh(x)^2 -\sinh(x)^2}{\cosh(x)^2} \\
&  =  \frac{1}{\cosh(x)^2}
\end{align*}


\subsubsection{Vérification avec Sage}


\subsection{Calcul d'une primitive de la fonction  $x \mapsto \tanh(x)$.}

\begin{center}
%\sageplot[width=.4\textwidth]{plot(tanh(x), x, -4, 4)} 
\sageplot[width=.4\textwidth]{plot(integrate(tanh(x), x) , x, -4, 4)} \\
La représentation graphique de $x \mapsto \sage{tanh(x)} $ et de sa dérivée.
\end{center}


\begin{align*}
\int \tanh(x) & = \int \frac{\cosh(x)}{\sinh(x)} \\
&  =  \int \frac{1}{u(x)} \times du(x), \quad \textrm{en posant } u(x) =  \cosh(x) \; \textrm{et donc } du(x) = \sinh(x) \\
&  =  \ln|u(x)| = \ln|\cosh(x)|  \quad \textrm{or } \cosh(x)>0 \; \textrm{sur } \R ,  \textrm{ donc}\\
&  =   \ln\left(\cosh(x)\right) + C^{ste} 
\end{align*}


\subsubsection{Vérification avec Sage}


\begin{sageblock}
    f(x) = tanh(x)
    F(x) = integrate(f(x),x)
\end{sageblock}

Une primitive de $\sage{f(x)} = \sage{F(x)} + C^{ste}$.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{La fonction  $x \mapsto \arg\mspace{-1mu}\cosh(x)$.}

Le cosinus hyperbolique, noté $\cosh$ est défini sur $\R$ selon l'expression $\frac{\exp(x)+\exp(-x)}{2}$, son domaine de valeurs est $[1, +\infty [$ 
c'est une fonction paire c'est-à-dire $\cosh(-x)=\cosh(x)$.


La fonction $x \mapsto \cosh(x)$ est inversible sur le domaine de définition restreint à $\R^+$, car elle y est bijective, son inverse est notée \og $ \arg\mspace{-1mu}\cosh $\fg et définit la fonction \og\emph{argument cosinus hyperbolique}\fg telle que $x \mapsto \arg\mspace{-1mu}\cosh(x)$.


\begin{center}
\sageplot[width=.5\textwidth]{plot(arccosh(x), x, 1, 20)} \\
La représentation graphique de $x \mapsto \arg\mspace{-1mu}\cosh(x)$.
\end{center}
On observe que la fonction est croissante, continue sur $\left[1\,,\,+\infty \right[ $ et dérivable sur l'intervalle ouvert $\left]1\,,\,+\infty \right[ $.
                                                                                               

\subsection{Dérivée de la fonction $x \mapsto \arg\mspace{-1mu}\cosh(x)$.\label{argcosh}}
On a la fonction composée $\Id = \cosh \circ \arg\mspace{-1mu}\cosh$ telle que $x\mapsto\cosh\left(\arg\mspace{-1mu}\cosh(x)\right)=x$ dont la dérivée s'écrit alors $1= \arg\mspace{-1mu}\cosh\nolimits' \times \cosh\nolimits'\circ\arg\mspace{-1mu}\cosh$.
\begin{align*}
x & =\cosh\left(\arg\mspace{-1mu}\cosh(x)\right)(x) \quad \textrm{en dérivant, on a}\\
1 & = \arg\mspace{-1mu}\cosh\nolimits'(x) \times \cosh\nolimits'\circ\arg\mspace{-1mu}\cosh(x) \quad \textrm{d'où}\\
\arg\mspace{-1mu}\cosh\nolimits'(x) & =\frac{1}{ \cosh\nolimits'\circ\arg\mspace{-1mu}\cosh(x)}=\frac{1}{ \sinh\left(\arg\mspace{-1mu}\sinh(x)\right)}\quad \textrm{or, on sait que}\\
1 & = \cosh\nolimits^2\left(\arg\mspace{-1mu}\cosh(x)\right) - \sinh\nolimits^2\left(\arg\mspace{-1mu}\cosh(x)\right) \quad \textrm{alors}\\
\sinh\left(\arg\mspace{-1mu}\cosh(x)\right) & = \sqrt{\cosh\nolimits^2\left(\arg\mspace{-1mu}\cosh(x)\right)-1}=\sqrt{x^2-1}\quad \textrm{finalement}\\
\arg\mspace{-1mu}\cosh\nolimits'(x) & = \frac{1}{ \sqrt{x^2-1}}\quad \textrm{on vérifie ce calcul avec Sage.}
\end{align*}


\subsubsection{Vérification avec Sage}


\begin{sageblock}
    f(x) = arccosh(x)
    g(x) = diff(f(x),x)
    F(x) = integrate(f(x),x)
\end{sageblock}

La dérivée de $\sage{f(x)} = \sage{g(x)} $.


\subsection{Calcul d'une primitive de la fonction  $x \mapsto \arg\mspace{-1mu}\cosh(x)$.}

Pour calculer $\int \arg\mspace{-1mu}\cosh(x) \, dx$, je procède par une intégration par parties en posant $u(x) = \arg\mspace{-1mu}\cosh(x)$ et $v'(x) = dx$, d'où $u'(x) = \frac{1}{ \sqrt{x^2-1}}$ et $ v(x) = x $. \\
On a donc
\begin{align*}
\int \arg\mspace{-1mu}\cosh(x) \, dx & = x \arg\mspace{-1mu}\cosh(x) - \int \frac{x}{ \sqrt{x^2-1}} \, dx \quad \textrm{or}\\
\int \frac{x}{ \sqrt{x^2-1}} \, dx & = \int \left(\sqrt{x^2-1}\right)' \, dx = \sqrt{x^2-1}  \quad \textrm{d'où}\\
\int \arg\mspace{-1mu}\cosh(x) \, dx & = x \arg\mspace{-1mu}\cosh(x) - \sqrt{x^2-1} + C^{ste} \quad \textrm{que l'on retrouve avec Sage.}
\end{align*}


\subsubsection{Vérification avec Sage}

Une primitive de $\sage{f(x)} = \sage{F(x)} + C^{ste} $.

\begin{center}
\sageplot[width=.3\textwidth]{plot(f(x), x, 1, 20)} 
\sageplot[width=.3\textwidth]{plot(g(x), x, 1, 20)} 
\sageplot[width=.3\textwidth]{plot(F(x), x, 1, 20)}\\
Les représentations graphiques respectivement de $x \mapsto \arg\mspace{-1mu}\cosh(x)$, de sa dérivée et de sa primitive.
\end{center}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{La fonction  $x \mapsto \arg\mspace{-1mu}\sinh(x)$.}

La fonction $x \mapsto \sinh(x)$ est inversible sur son domaine de définition $\R$, car elle y est bijective, son inverse est notée \og$ \arg\mspace{-1mu}\sinh $\fg et définit la fonction \og\emph{argument sinus hyperbolique}\fg telle que $x \mapsto \arg\mspace{-1mu}\sinh(x)$.


\begin{center}
\sageplot[width=.5\textwidth]{plot(arcsinh(x), x, -20, 20)} \\
La représentation graphique de $x \mapsto \arg\mspace{-1mu}\sinh(x)$.
\end{center}
On observe que la fonction est croissante, impaire $\arg\mspace{-1mu}\sinh(-x) = -\arg\mspace{-1mu}\sinh(x) $
et on observe que la fonction est continue et dérivable sur $\R$.                                                                                                             

\subsection{Dérivée de la fonction $x \mapsto \arg\mspace{-1mu}\sinh(x)$.\label{argsinh}}
On a la fonction composée $\Id = \sinh \circ \arg\mspace{-1mu}\sinh$ telle que $x\mapsto\sinh\left(\arg\mspace{-1mu}\sinh(x)\right)=x$ dont la dérivée s'écrit alors $1= \arg\mspace{-1mu}\sinh\nolimits' \times \sinh\nolimits'\circ\arg\mspace{-1mu}\sinh$.
\begin{align*}
x & =\sinh\left(\arg\mspace{-1mu}\sinh(x)\right)(x) \quad \textrm{en dérivant, on a}\\
1 & = \arg\mspace{-1mu}\sinh\nolimits'(x) \times \sinh\nolimits'\circ\arg\mspace{-1mu}\sinh(x) \quad \textrm{d'où}\\
\arg\mspace{-1mu}\sinh\nolimits'(x) & =\frac{1}{ \sinh\nolimits'\circ\arg\mspace{-1mu}\sinh(x)}=\frac{1}{ \cosh\left(\arg\mspace{-1mu}\sinh(x)\right)}\quad \textrm{or}\\
\cosh\left(\arg\mspace{-1mu}\sinh(x)\right) & = \sqrt{1+\sinh\nolimits^2\left(\arg\mspace{-1mu}\sinh(x)\right)}=\sqrt{1+x^2}\quad \textrm{donc}\\
\arg\mspace{-1mu}\sinh\nolimits'(x) & = \frac{1}{ \sqrt{1+x^2}}\quad \textrm{on vérifie ce calcul avec Sage.}
\end{align*}


\subsubsection{Vérification avec Sage}


\begin{sageblock}
    f(x) = arcsinh(x)
    g(x) = diff(f(x),x)
    F(x) = integrate(f(x),x)
\end{sageblock}

La dérivée de $\sage{f(x)} = \sage{g(x)} $.


\subsection{Calcul d'une primitive de la fonction  $x \mapsto \arg\mspace{-1mu}\sinh(x)$.}

Pour calculer $\int \arg\mspace{-1mu}\sinh(x) \, dx$, je procède par une intégration par parties en posant $u(x) = \arg\mspace{-1mu}\sinh(x)$ et $v'(x) = dx$, d'où $u'(x) = \frac{1}{ \sqrt{1+x^2}}$ et $ v(x) = x $. \\
On a donc
\begin{align*}
\int \arg\mspace{-1mu}\sinh(x) \, dx & = x \arg\mspace{-1mu}\sinh(x) - \int \frac{x}{ \sqrt{1+x^2}} \, dx \quad \textrm{or}\\
\int \frac{x}{ \sqrt{1+x^2}} \, dx & = \int \left(\sqrt{1+x^2}\right)' \, dx = \sqrt{1+x^2}  \quad \textrm{d'où}\\
\int \arg\mspace{-1mu}\sinh(x) \, dx & = x \arg\mspace{-1mu}\sinh(x) - \sqrt{1+x^2} + C^{ste} \quad \textrm{que l'on retrouve avec Sage.}
\end{align*}


\subsubsection{Vérification avec Sage}

Une primitive de $\sage{f(x)} = \sage{F(x)} + C^{ste} $.

\begin{center}
\sageplot[width=.3\textwidth]{plot(f(x), x, -20, 20)} 
\sageplot[width=.3\textwidth]{plot(g(x), x, -20, 20)} 
\sageplot[width=.3\textwidth]{plot(F(x), x, -20, 20)}\\
Les représentations graphiques respectivement de $x \mapsto \arg\mspace{-1mu}\sinh(x)$, de sa dérivée et de sa primitive.
\end{center}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{La fonction  $x \mapsto \arg\mspace{-1mu}\tanh(x)$.}

La fonction $x \mapsto \tanh(x)$ est inversible sur son domaine de définition $\R$, car elle y est bijective, son inverse est notée \og$ \arg\mspace{-1mu}\tanh $\fg et définit la fonction \og\emph{argument tangente hyperbolique}\fg telle que $x \mapsto \arg\mspace{-1mu}\tanh(x)$.


\begin{center}
\sageplot[width=.5\textwidth]{plot(arctanh(x), x, -1, 1)} \\
La représentation graphique de $x \mapsto \arg\mspace{-1mu}\tanh(x)$.
\end{center}
On observe que la fonction est croissante, impaire $\arg\mspace{-1mu}\sinh(-x) = -\arg\mspace{-1mu}\sinh(x) $
et on observe que la fonction est continue et dérivable sur l'intervalle ouvert $]-1,1[$.                                                                                                             

\subsection{Dérivée de la fonction $x \mapsto \arg\mspace{-1mu}\tanh(x)$.}
On a la fonction composée $\Id = \tanh \circ \arg\mspace{-1mu}\tanh$ telle que $x\mapsto\tanh\left(\arg\mspace{-1mu}\tanh(x)\right)=x$ dont la dérivée s'écrit alors $1= \arg\mspace{-1mu}\tanh\nolimits' \times \tanh\nolimits'\circ\arg\mspace{-1mu}\tanh$.
\begin{align*}
x & =\tanh\left(\arg\mspace{-1mu}\tanh(x)\right)(x) \quad \textrm{en dérivant, on a}\\
1 & = \arg\mspace{-1mu}\tanh\nolimits'(x) \times \tanh\nolimits'\circ\arg\mspace{-1mu}\tanh(x) \quad \textrm{d'où}\\
\arg\mspace{-1mu}\tanh\nolimits'(x) & =\frac{1}{ \tanh\nolimits'\circ\arg\mspace{-1mu}\tanh(x)}\quad \textrm{or, la dérivée de } \tanh \; \textrm{vaut}\\
\tanh\nolimits' & = 1-\tanh\nolimits^2 \quad \textrm{donc} \\
%\arg\mspace{-1mu}\tanh\nolimits'(x) & =\frac{1}{ \tanh\nolimits'\circ\arg\mspace{-1mu}\tanh(x)}\\
\tanh\nolimits'\left(\arg\mspace{-1mu}\tanh(x)\right) & = 1 - \tanh\nolimits^2 \left(\arg\mspace{-1mu}\tanh(x)\right) = 1 - x^2 \quad \textrm{finalement}\\
\arg\mspace{-1mu}\tanh\nolimits'(x) & = \frac{1}{ 1- x^2} \quad \textrm{on vérifie ce calcul avec Sage.}
\end{align*}


\subsubsection{Vérification avec Sage}


\begin{sageblock}
    f(x) = arctanh(x)
    g(x) = diff(f(x),x)
    F(x) = integrate(f(x),x)
\end{sageblock}

La dérivée de $\sage{f(x)} = \sage{g(x)} $.


\subsection{Calcul d'une primitive de la fonction  $x \mapsto \arg\mspace{-1mu}\tanh(x)$.}

Pour calculer $\int \arg\mspace{-1mu}\tanh(x) \, dx$, je procède par une intégration par parties en posant $u(x) = \arg\mspace{-1mu}\tanh(x)$ et $v'(x) = dx$, d'où $u'(x) = \frac{1}{ 1 - x^2 }$ et $ v(x) = x $. \\
On a donc
\begin{align*}
\int \arg\mspace{-1mu}\tanh(x) \, dx & = x \arg\mspace{-1mu}\tanh(x) - \int  \frac{x}{ 1 - x^2 } \, dx \quad \textrm{on reconnaît dans}\\
- \int  \frac{x}{ 1 - x^2 } \, dx & = -\frac{1}{-2} \int  \frac{d(1 - x^2 )}{ 1 - x^2 } \, dx = \frac{1}{2} \int  \frac{d(1 - x^2 )}{ 1 - x^2 } \, dx  \quad \textrm{d'où}\\
\int \arg\mspace{-1mu}\tanh(x) \, dx & = x \arg\mspace{-1mu}\tanh(x) + \frac{1}{2} \ln|1- x^2| + C^{ste} \quad \textrm{or} \; x \, \in ]-1, 1[ \\
\int \arg\mspace{-1mu}\tanh(x) \, dx & = x \arg\mspace{-1mu}\tanh(x) + \frac{1}{2} \ln(1- x^2) + C^{ste} \quad \textrm{que l'on retrouve avec Sage.}
\end{align*}


\subsubsection{Vérification avec Sage}

Une primitive de $\sage{f(x)} = \sage{F(x)} + C^{ste} $.

\begin{center}
\sageplot[width=.3\textwidth]{plot(f(x), x, -1, 1)} 
\sageplot[width=.3\textwidth]{plot(g(x), x, -0.9, 0.9)} 
\sageplot[width=.3\textwidth]{plot(F(x), x, -1, 1)}\\
Les représentations graphiques respectivement de $x \mapsto \arg\mspace{-1mu}\tanh(x)$, de sa dérivée et de sa primitive.
\end{center}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Récapitulation de nos travaux et de leurs résultats}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Dérivées, fonctions, primitives des fonctions trigonométriques}

\begin{align*}
\textrm{dérivée} \hspace{2cm} & \textrm{fonction} \hspace{2cm} & \textrm{primitive}  \\ 
x \mapsto -\sin(x) \hspace{2cm} & x \mapsto \cos(x) \hspace{2cm} & \sin(x) + C^{ste}  \\
x \mapsto \cos(x) \hspace{2cm} & x \mapsto \sin(x) \hspace{2cm} & -\cos(x) + C^{ste}   \\
x \mapsto 1 + \tan\nolimits^2(x) \hspace{2cm} & x \mapsto \tan(x) \hspace{2cm} & -\ln\left| \cos(x)\right| + C^{ste} \\
\end{align*}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Dérivées, fonctions, primitives des fonctions trigonométriques inverses}

\begin{align*}
\textrm{dérivée} \hspace{1.5cm} & \textrm{fonction} \hspace{1.5cm} & \textrm{primitive}  \\ 
x \mapsto \frac{-1}{ \sqrt{1 - x^2}} \hspace{1.5cm} & x \mapsto \arccos(x) \hspace{1.5cm} & x \arccos(x) - \sqrt{1 - x^2 } + C^{ste}  \\
x \mapsto \frac{1}{ \sqrt{1 - x^2}} \hspace{1.5cm} & x \mapsto \arcsin(x) \hspace{1.5cm} & x \arcsin(x) + \sqrt{1 - x^2 } + C^{ste}   \\
x \mapsto \frac{1}{ 1 + x^2} \hspace{1.5cm} & x \mapsto \arctan(x) \hspace{1.5cm} &  x \arctan(x) - \frac{1}{2} \ln( 1 + x^2) + C^{ste} \\
\end{align*}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Dérivées, fonctions, primitives des fonctions trigonométriques hyperboliques}

\begin{align*}
\textrm{dérivée} \hspace{2cm} & \textrm{fonction} \hspace{2cm} & \textrm{primitive}  \\ 
x \mapsto \sinh(x) \hspace{2cm} & x \mapsto \cosh(x) \hspace{2cm} & \sinh(x) + C^{ste}  \\
x \mapsto \cosh(x) \hspace{2cm} & x \mapsto \sinh(x) \hspace{2cm} & \cosh(x) + C^{ste}   \\
x \mapsto 1 - \tanh\nolimits^2(x) \hspace{2cm} & x \mapsto \tanh(x) \hspace{2cm} & \ln( \cosh(x)) + C^{ste} \\
\end{align*}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Dérivées, fonctions, primitives des fonctions trigonométriques hyperboliques inverses}

\begin{align*}
\textrm{dérivée} \hspace{1.5cm} & \textrm{fonction} \hspace{1.5cm} & \textrm{primitive}  \\ 
x \mapsto \frac{1}{ \sqrt{x^2-1}} \hspace{1.5cm} & x \mapsto \arg\mspace{-1mu}\cosh(x) \hspace{1.5cm} & x \arg\mspace{-1mu}\cosh(x) - \sqrt{x^2-1} + C^{ste}  \\
x \mapsto \frac{1}{ \sqrt{x^2+1}} \hspace{1.5cm} & x \mapsto \arg\mspace{-1mu}\sinh(x) \hspace{1.5cm} & x \arg\mspace{-1mu}\sinh(x) - \sqrt{x^2 +1 } + C^{ste}   \\
x \mapsto \frac{1}{ 1 - x^2} \hspace{1.5cm} & x \mapsto \arg\mspace{-1mu}\tanh(x) \hspace{1.5cm} &  x \arg\mspace{-1mu}\tanh(x) + \frac{1}{2} \ln(1- x^2) + C^{ste} \\
\end{align*}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\chapter{Calcul de quelques primitives.}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{La fonction  $x \mapsto \ln(x) $.}

\begin{align*}
\int \ln(x) & =  \int \ln(x) \times 1 \\ & =  x \times \ln(x) - \int \ln(x)' \times x dx \\ & =  x \times \ln(x) - \int  dx \\ & =   x  \ln(x) - x + C^{ste}
\end{align*}

\subsection{Calcul de la dérivée de la fonction $x \mapsto \ln(x) $.}


\subsubsection{Première Méthode}


Passons par les limites pour trouver Une primitive de $\ln(x)$,

$ \lim_{h \mapsto 0} \frac{\ln(x+h) - \ln(x}{h} = \lim_{h \mapsto 0} \frac{\ln(\frac{x+h}{x})}{h}  = \lim_{h \mapsto 0} \frac{ \ln(1+X)}{x\times X}$, avec $X=\frac{h}{x}$.


On a donc 

$\lim_{h \mapsto 0} \frac{\ln(1+X)}{x\times X} = \frac{1}{x} \times \lim_{h \mapsto 0} \frac{\ln(1+X)}{X} = \frac{1}{x} \times 1 = \frac{1}{x}$.




\subsubsection{Seconde Méthode}

Pour ce calcul, il faut utiliser le calcul de la dérivée d'une fonction composée. 

On a $\exp((\ln(x))=x)$, par conséquent la dérivée de cette expression s'exprime par $ \exp(\ln(x)) \times (\ln(x)' = 1$, d'où $(\ln(x))' = \frac{1}{\exp(\ln(x))}  = \frac{1}{x} $.

\subsubsection{Vérification avec Sage}

\begin{sageblock}
    f(x) = ln(x)
    g(x) = diff(f(x),x,1)
\end{sageblock}

La dérivée de $\sage{f(x)} = \sage{g(x)} $.

Le graphe de $\sage{f(x)} $.


\begin{center}
\sageplot[width=.5\textwidth]{plot(f(x), x, 0, 10)} \\
%\sageplot{plot(g(x), x, -1, 1)}
\end{center}


On peut maintenant entreprendre le calcul d'une primitive de la  fonction  $x \mapsto \ln(x) $.


\subsection{Calcul d"une primitive de la fonction  $x \mapsto \ln(x) $.}


Je pose que $u(x)$  est égal à la fonction $\ln(x)$ et $v'(x)$ est égal $1$  d'où $u'(x)$  est égal à la fonction $ \frac{1}{1+ x^2} $ et $v(x)$ est égal $x$.

Alors on a $\int \ln(x) \, dx = x \times \ln(x) -\int \frac{1}{x} \times x \, dx $.


\subsubsection{Calcul de $\int \frac{x}{x} \, dx $.}

$\int \frac{x}{x} \, dx = \int 1 \, dx = x$.


Finalement $\int \ln(x) \, dx = x \times \ln(x) -x + C^{ste} $

\subsubsection{Vérification avec Sage}

\begin{sageblock}
    f(x) = log(x)
    F(x) = integrate(f(x),x)
\end{sageblock}

Une primitive de $\sage{f(x)} = \sage{F(x)} + C^{ste} $.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{La fonction  $x \mapsto \exp(x) $.}

\begin{align*}
\int \exp(x) = \exp(x) + C^{ste}.
\end{align*}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Calcul d'une primitive de $ x \longmapsto  \frac{dx}{\sqrt{x^2 - 1} } $. }


Je pose $y-x = \sqrt{x^2 - 1} $ avec $y - x = \sqrt{x^2 - 1} \geqslant 0 $, donc $y \geqslant  x$.

Quel est le signe de $y$ c'est-à-dire le signe de $x + \sqrt{x^2 - 1} $?

La fonction $ x\mapsto x + \sqrt{x^2 - 1} $ est définie, continue et dérivable sur l'intervalle ouvert $ ]-\infty,-1[ \, \cup \, ]1,+\infty[ $.

\begin{center}
\sageplot[width=.4\textwidth]{plot(x+sqrt(x^2-1), x, -5, -1)} 
\sageplot[width=.4\textwidth]{plot(diff(x+sqrt(x^2-1),x), x, -5, -1)} \\
La représentation graphique de $x + \sqrt{x^2-1}$ et de sa dérivée sur l'intervalle $ ]-\infty,-1[ $.
\end{center}
La fonction $ x\mapsto x + \sqrt{x^2 - 1} < 0 $ donc $ y < 0 $ sur l'intervalle $ ]-\infty,-1[ $.

\begin{center}
\sageplot[width=.4\textwidth]{plot(x+sqrt(x^2-1), x, 1, 5)} 
\sageplot[width=.4\textwidth]{plot(diff(x+sqrt(x^2-1),x), x, 1, 5)} \\
La représentation graphique de $x + \sqrt{x^2-1}$ et de sa dérivée sur l'intervalle $ ]1,+\infty[ $.
\end{center}

La fonction $ x\mapsto x + \sqrt{x^2 - 1} > 0 $ donc $ y > 0 $ sur l'intervalle $ 1,+\infty[ $.




En élevant au carré, on a 
\begin{align*}
(y-x)^2 & = x^2 - 1 \\
y^2 - 2yx + x^2 & = x^2 - 1 \\
y^2 - 2yx  & = -1 \quad \textrm{ puis en différentiant chaque variable} \\
2ydy - 2dy \times x - 2ydx & = 0 \\
(y-x)dy & = ydx \\
\frac{dy}{y} & = \frac{dx}{(y-x)} = \frac{dx}{\sqrt{x^2-1} } \\
\int \frac{dy}{y} = \ln|y| + C^{ste} & = \int \frac{dx}{\sqrt{x^2-1} } dx \\
\ln\left|x + \sqrt{x^2-1}\right| + C^{ste} & = \int \frac{dx}{\sqrt{x^2-1} } dx  \quad \textrm{autrement écrit}\\ 
\ln(-x - \sqrt{x^2-1}) + C^{ste} & = \int \frac{dx}{\sqrt{x^2-1} } dx  \quad \textrm{pour} \;  x \in ]-\infty,-1[ \\
\ln(x + \sqrt{x^2-1}) + C^{ste} & = \int \frac{dx}{\sqrt{x^2-1} } dx  \quad \textrm{pour} \; x \in ]1,+\infty[ .
\end{align*}
Or, nous avons déjà vu en~\ref{argcosh}, page~\pageref{argcosh} que la dérivée de la fonction  $x \mapsto \arg\mspace{-1mu}\cosh(x)$  vaut $ \frac{1}{ \sqrt{1-x^2}}$ ce qui implique que $\ln\left|x + \sqrt{x^2-1}\right| + C^{ste} = \arg\mspace{-1mu}\cosh\nolimits(x) $. Montrons-le !

\subsection{Avons nous $\arg\mspace{-1mu}\cosh\nolimits(x) = \ln\left|x + \sqrt{x^2-1}\right| + C^{ste} $ ?}

Posons $ y = \arg\mspace{-1mu}\cosh\nolimits(x) $, comme $ \arg\mspace{-1mu}\cosh\nolimits $ est la fonction inverse de $\cosh$, on a $\cosh(y) = \frac{\exp(y) + \exp(-y)}{2} = \cosh(\arg\mspace{-1mu}\cosh\nolimits(x)) = x $ d'où $ \exp(y) + \exp(-y) -2x = 0 $ et en multipliant par $\exp(y)$, on obtient l'équation du second degré ordonné en $\exp(y)$,
\begin{equation}
\label{equa01}
\left(\exp(y) \right)^2 - 2x \exp(y) +1 = 0, 
\end{equation}
dont le discriminant $\Delta$ vaut $4x^2 - 4 > 0$ pour $ x \in ]-\infty,-1[ \, \cup \, ]1,+\infty[ $, ainsi les solutions s'écrivent $ \exp(y_1) = x + \frac{\sqrt{4x^2 - 4}}{2} = x + \sqrt{x^2-1}$ et $ \exp(y_2) = x - \frac{\sqrt{4x^2 - 4}}{2} = x - \sqrt{x^2-1}$. 

La fonction exponentielle étant toujours positive sur $\R$, alors  les solutions de l'équation du second degré~\ref{equa01} sont celles pour  $ x \in ]1,+\infty[ $. En effet, pour $ x \in ]-\infty,-1[ $, les fonctions $x \mapsto x + \sqrt{x^2-1}$ et $x \mapsto x - \sqrt{x^2-1}$ sont négatives.

Les seules solutions qui conviennent sont  $\exp(y)  = x + \sqrt{x^2-1}$ et $\exp(y) = x - \sqrt{x^2-1}$ pour $ x \in ]1,+\infty[ $.


Finalement, on a  $y = \arg\mspace{-1mu}\sinh\nolimits(x) = \ln(x + \sqrt{x^2-1})$ et $y = \arg\mspace{-1mu}\sinh\nolimits(x) = \ln(x - \sqrt{x^2-1})$ pour $ x \in ]1,+\infty[ $.



\begin{center}
\sageplot[width=.2\textwidth]{plot((x+sqrt(x^2-1)), x, 1, 5)} 
%\sageplot[width=.2\textwidth]{plot((x+sqrt(x^2-1)), x, -5, -1)} 
\sageplot[width=.2\textwidth]{plot((x-sqrt(x^2-1)), x, 1, 5)} 
%\sageplot[width=.2\textwidth]{plot((x-sqrt(x^2-1)), x, -5, -1)} 
\\
\sageplot[width=.2\textwidth]{plot(arccosh(x), x, 1, 5)} \\
\sageplot[width=.2\textwidth]{plot(log(x+sqrt(x^2-1)), x, 1, 5)} 
\sageplot[width=.2\textwidth]{plot(log(x-sqrt(x^2-1)), x, 1, 5)} 
%\sageplot[width=.2\textwidth]{plot(log(x+sqrt(x^2-1)), x, -5, -1)} 
\\
Les représentations graphiques de $\ln(x + \sqrt{x^2-1})$ et de $\arg\mspace{-1mu}\cosh\nolimits(x)$.
\end{center}


Nous avons montré l'égalité $\arg\mspace{-1mu}\cosh\nolimits(x) = \ln(x + \sqrt{x^2-1}) + C^{ste} $ pour $ x \in ]1,+\infty[ $.


\section{Calcul d'une primitive de $ x \longmapsto  \frac{dx}{\sqrt{x^2 + 1} } $. }


Je pose $y-x = \sqrt{x^2+1} $ avec $y - x = \sqrt{x^2 + 1} \geqslant 0 $, donc $y \geqslant  x$.

Quel est le signe de $y$ c'est-à-dire le signe de $x + \sqrt{x^2+1} $?

\begin{center}
\sageplot[width=.4\textwidth]{plot(x+sqrt(x^2+1), x, -5, 5)} 
\sageplot[width=.4\textwidth]{plot(diff(x+sqrt(x^2+1),x), x, -5, 5)} \\
La représentation graphique de $x + \sqrt{x^2+1}$ et de sa dérivée.
\end{center}



En élevant au carré, on a 
\begin{align*}
(y-x)^2 & = x^2 + 1 \\
y^2 - 2yx + x^2 & = x^2 + 1 \\
y^2 - 2yx  & = 1 \quad \textrm{ puis en différentiant chaque variable} \\
2ydy - 2dy \times x - 2ydx & = 0 \\
(y-x)dy & = ydx \\
\frac{dy}{y} & = \frac{dx}{(y-x)} = \frac{dx}{\sqrt{x^2+1} } \\
\int \frac{dy}{y} = \ln|y| + C^{ste} & = \int \frac{dx}{\sqrt{x^2+1} } dx \quad \textrm{or} \; y = x + \sqrt{x^2+1}  \geqslant 0 \\
\ln(x + \sqrt{x^2+1}) + C^{ste} & = \int \frac{dx}{\sqrt{x^2+1} } dx  
\end{align*}
Or, nous avons déjà vu en~\ref{argsinh}, page~\pageref{argsinh} que la dérivée de la fonction  $x \mapsto \arg\mspace{-1mu}\sinh(x)$  vaut $ \frac{1}{ \sqrt{1+x^2}}$ ce qui implique que $\ln(x + \sqrt{x^2+1}) + C^{ste} = \arg\mspace{-1mu}\sinh\nolimits(x) $. Montrons-le !

\subsection{Avons nous $\arg\mspace{-1mu}\sinh\nolimits(x) = \ln(x + \sqrt{x^2+1}) + C^{ste} $ ?}

Posons $ y = \arg\mspace{-1mu}\sinh\nolimits(x) $, comme $ \arg\mspace{-1mu}\sinh\nolimits $ est la fonction inverse de $\sinh$, on a $\sinh(y) = \frac{\exp(y) - \exp(-y)}{2} = x$ d'où $2x = \exp(y) - \exp(-y) $ et en multipliant par $\exp(y)$, on obtient l'équation du second degré en $\exp(y)$,
\begin{equation}
\left(\exp(y) \right)^2 - 2x \exp(y) -1 = 0, 
\end{equation}
dont le discriminant $\Delta$ vaut $4x^2 + 4 \neq 0$, ainsi les solutions s'écrivent $ \exp(y_1) = x + \frac{\sqrt{4x^2 + 4}}{2} = x + \sqrt{x^2+1}$ et $ \exp(y_2) = x - \frac{\sqrt{4x^2 + 4}}{2} = x - \sqrt{x^2+1}$. 

On ne retient que la solution $ \exp(y) = x + \sqrt{x^2+1}$ puisque la fonction exponentielle est toujours positive et que $ \exp(y_2) = x - \sqrt{x^2+1} < 0 $.

Finalement, $y = \arg\mspace{-1mu}\sinh\nolimits(x) = \ln(x + \sqrt{x^2+1})$.


\begin{center}
\sageplot[width=.3\textwidth]{plot(log(x+sqrt(x^2+1)), x, -5, 5)} 
%\sageplot[width=.3\textwidth]{plot(log(x-sqrt(x^2+1)), x, -5, 0)} 
\sageplot[width=.3\textwidth]{plot(arcsinh(x), x, -5, 5)} \\
Les représentations graphiques de $\ln(x + \sqrt{x^2+1})$ et de $\arg\mspace{-1mu}\sinh\nolimits(x)$.
\end{center}


Nous avons montré l'égalité $\arg\mspace{-1mu}\sinh\nolimits(x) = \ln(x + \sqrt{x^2+1}) + C^{ste} $.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Calcul d'une primitive de $  x \longmapsto  \frac{dx}{\sqrt{x^2+ x + 1} } $. }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Calcul d'une primitive de $  x \longmapsto  \frac{dx}{\sqrt{x^2+ \alpha^2} } $. }

\subsection{Vérification avec Sage}



\subsubsection{Calcul d'une primitive de $  x \longmapsto  \frac{dx}{\sqrt{x^2+ a^2} } $ par un changement de variable puis par l'emploi d'une variable auxiliaire} 

\subsubsection{Vérification avec Sage}

\section{Calcul d'une primitive de $  x \longmapsto  \sqrt{x^2 + 1}  $ \label{sqrt-001} }

\subsubsection{Vérification avec Sage}





\end{document}